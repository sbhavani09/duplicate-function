val simpleDF=simpleData.toDF("empname","dept","sal")
simpleDF.show()
val windowSpc=Window.partitionBy("dept").orderBy("sal")
val windowSpcagg=Window.partitionBy("dept")
val aggDF=simpleDF.withColumn("row",row_number.over(windowSpc))
.withColumn("avg",avg(col("sal")).over(windowSpcagg))
.withColumn("sum",sum(col("sal")).over(windowSpcagg))
.withColumn("min",min(col("sal")).over(windowSpcagg))
.withColumn("max",max(col("sal")).over(windowSpcagg))
.where(col("row")===1.select("dept","avg","sum","min","max").show()